<script is:inline>
  /**
   * Determines whether the user prefers the dark theme.
   * Checks localStorage first, then falls back to system preference.
   * @returns {boolean} True if dark mode is preferred, false otherwise.
   */
  function getThemePreference() {
    if (typeof localStorage !== "undefined") {
      return localStorage.getItem("dark") === "ok";
    }

    return window.matchMedia("(prefers-color-scheme: dark)").matches;
  }

  /**
   * Applies the dark theme to the document if the user prefers it.
   * Also sets `aria-pressed` on the toggle button for accessibility.
   */
  function applyThemePreference() {
    const prefersDark = getThemePreference();

    if (prefersDark) {
      document.documentElement.classList.add("dark");

      const button = document.getElementById("toggle-theme");
      if (button) {
        button.setAttribute("aria-pressed", "true");
      }
    }
  }

  applyThemePreference();
</script>
